<!DOCTYPE html>
<html>
<head>
  <title>Treasure Tax</title>
  <style>
    body {
      margin:0;
      background:#0d0d0d;
      color:#e0e0e0;
      font-family:Arial, sans-serif;
      text-align:center;
    }

    #titleScreen, #gameScreen, #winScreen, #settingsScreen { display:none; }

    #titleScreen, #winScreen, #settingsScreen {
      display:flex;
      flex-direction:column;
      justify-content:center;
      align-items:center;
      height:100vh;
      gap:25px;
      background:linear-gradient(135deg, #000, #1c1c1c);
    }

    h1 {
      font-size:3rem;
      letter-spacing:3px;
      text-shadow:0 0 10px #00f0ff;
    }

    .menuBtn, select {
      padding:14px 30px;
      font-size:18px;
      background:#111;
      color:#00f0ff;
      border:2px solid #00f0ff;
      border-radius:8px;
    }

    #board {
      display:grid;
      gap:3px;
      width:max-content;
      margin:20px auto;
      padding:10px;
      background:#111;
      border:2px solid #00f0ff;
      box-shadow:0 0 20px #00f0ff55;
    }

    .cell {
      width:40px;
      height:40px;
      background:#1a1a1a;
      border:1px solid #333;
      display:flex;
      justify-content:center;
      align-items:center;
      color:#00f0ff;
      font-size:12px;
    }

    .wall {
      background:#333;
      border:1px solid #555;
    }

    #turn {
      margin-top:10px;
      color:#00f0ff;
      font-size:18px;
    }
  </style>
</head>

<body>

<div id="titleScreen">
  <h1>Treasure Tax</h1>
  <button class="menuBtn" id="startBtn">Enter Func Room</button>
  <button class="menuBtn" id="settingsBtn">Settings</button>
</div>

<div id="settingsScreen">
  <h1>Settings</h1>
  <select id="difficulty">
    <option value="easy">Easy</option>
    <option value="medium" selected>Medium</option>
    <option value="hard">Tuff</option>
  </select>
  <button class="menuBtn" id="backBtn">Back</button>
</div>

<div id="gameScreen">
  <h2 style="color:#00f0ff;">Func Room</h2>
  <div id="board"></div>
  <div id="turn"></div>
</div>

<div id="winScreen">
  <h1 id="winnerText"></h1>
  <button class="menuBtn" id="playAgainBtn">Play Again</button>
</div>

<script>
  let size = 13;
  let wallCount = 20;

  const board = document.getElementById("board");
  const turnDisplay = document.getElementById("turn");
  const winnerText = document.getElementById("winnerText");
  const difficultySelect = document.getElementById("difficulty");

  let currentTurn = 1;
  let walls = [];
  let p1, p2, treasure;

  function applyDifficulty() {
    const d = difficultySelect.value;

    if (d === "easy") {
      size = 11;
      wallCount = 12;
    }

    if (d === "medium") {
      size = 13;
      wallCount = 20;
    }

    if (d === "hard") {
      size = 17;
      wallCount = 38;
    }

    board.style.gridTemplateColumns = `repeat(${size}, 40px)`;
    board.style.gridTemplateRows = `repeat(${size}, 40px)`;
  }

  function show(screen) {
    titleScreen.style.display = "none";
    gameScreen.style.display = "none";
    winScreen.style.display = "none";
    settingsScreen.style.display = "none";
    screen.style.display = "flex";
  }

  function resetGame() {
    applyDifficulty();
    currentTurn = 1;
    p1 = { x: 0, y: size - 1 };
    p2 = { x: size - 1, y: size - 1 };
    treasure = { x: Math.floor(size / 2), y: 0 };
    generateWalls();
    drawBoard();
  }

  startBtn.onclick = () => {
    show(gameScreen);
    resetGame();
  };

  playAgainBtn.onclick = () => {
    show(gameScreen);
    resetGame();
  };

  settingsBtn.onclick = () => show(settingsScreen);
  backBtn.onclick = () => show(titleScreen);

  function generateWalls() {
    walls = [];
    while (walls.length < wallCount) {
      let wx = Math.floor(Math.random() * size);
      let wy = Math.floor(Math.random() * size);
      if (wy === size - 1) continue;
      if ((wx === p1.x && wy === p1.y) || (wx === p2.x && wy === p2.y)) continue;
      if (wx === treasure.x && wy === treasure.y) continue;
      if (walls.some(w => w.x === wx && w.y === wy)) continue;
      walls.push({ x: wx, y: wy });
    }
  }

  function isWall(x, y) {
    return walls.some(w => w.x === x && w.y === y);
  }

  function drawBoard() {
    board.innerHTML = "";
    for (let y = 0; y < size; y++) {
      for (let x = 0; x < size; x++) {
        const cell = document.createElement("div");
        cell.className = isWall(x, y) ? "cell wall" : "cell";
        if (x === treasure.x && y === treasure.y) cell.textContent = "ðŸ’°";
        if (x === p1.x && y === p1.y) cell.textContent = "P1";
        if (x === p2.x && y === p2.y) cell.textContent = "P2";
        board.appendChild(cell);
      }
    }
    turnDisplay.textContent = `Player ${currentTurn} Turn`;
  }

  function movePlayer(num, direction) {
    if (num !== currentTurn) return;

    let p = num === 1 ? p1 : p2;
    let nx = p.x;
    let ny = p.y;

    if (direction === "up") ny--;
    if (direction === "down") ny++;
    if (direction === "left") nx--;
    if (direction === "right") nx++;

    if (nx < 0 || ny < 0 || nx >= size || ny >= size) return;
    if (isWall(nx, ny)) return;

    p.x = nx;
    p.y = ny;

    if (p.x === treasure.x && p.y === treasure.y) {
      show(winScreen);
      winnerText.textContent = `Player ${num} Wins!`;
      return;
    }

    currentTurn = currentTurn === 1 ? 2 : 1;
    drawBoard();
  }

  document.addEventListener("keydown", e => {
    const k = e.key.toLowerCase();
    if (k === "w") movePlayer(currentTurn, "up");
    if (k === "s") movePlayer(currentTurn, "down");
    if (k === "a") movePlayer(currentTurn, "left");
    if (k === "d") movePlayer(currentTurn, "right");
  });

  show(titleScreen);
</script>

</body>
</html>
